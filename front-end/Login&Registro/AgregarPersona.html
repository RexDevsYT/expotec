<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewpoEFrt" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="LCSS2">
    <link rel="stylesheet" href="MCSS1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.js"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="persona.js"></script>
    <title></title>
</head>


    <header>
        <div class="menu_bar">
            <i class="fa-solid fa-ellipsis-vertical"></i>
                    <a href="#" class="btn_menu">Menu</a>
        </div>
        <nav>
            <span id="logo"> <img src="/Desarrollo" width="100psx"
                 height="60px" alt=""> 
            </span>
            <ul>
                <li><a href="">‎‎‎</a>
            </ul>
        </nav>
    </header>
    
    <br>
<form class="SIUUU">
    <div class="modal-wrap">
        <div class="modal-header">
          <span class="is-active"></span>
          <span></span>
          <span></span>
        </div>

        <div class="modal-bodies">
          <div class="modal-body modal-body-step-1 is-showing">
            <div class="title">Paso 1</div>
            <div class="description">Introduce tu informacion</div>
            <form>
              <i class="fa-solid fa-address-book"></i>
              <input type="text" id="NOMBRE" placeholder="Nombre" />
              <input type="text" id="APELLIDO" placeholder="Apellido" />
              <input type="date" id="FECHAN" placeholder="Fecha de nacimiento" />
              <BR>
              
              <div class="description" ><i class="fa-solid fa-genderless"></i>Genero  <select id="GENERO">
                <option value="Otro">No definido</option>
                <option value="Masculino">Masculino</option>
                <option value="Femenino">Femenino</option>
                <option value="Femenino">Otro</option>
            </select></div>
              <div class="text-center">
                <a id="Botton-Ir-Login" href="/Login"> Login</a>
                <div class="button">Siguiente</div>
              
  
              </div>
              
              
            </form>
          </div>

          <div class="modal-body modal-body-step-2">
            <div class="title">Paso 2</div>
            <form>
                <div class="description">¿Que eres?  <select id="TIPOUSUARIO">
                    <option value="Estudiante">Estudiante</option>
                    <option value="Entusiasta">Entusiasta</option>
                    <option value="UsuarioCasual">Usuario casual</option>
                </select></div>
                <div class="file-select" id="src-file1" >
                    <input type="file" id="FOTO" name="src-file1" aria-label="Foto de perfil" style="border-radius: 10px;">
                  </div>
              <div class="text-center fade-in">
                
                <div class="back-button">Volver Atrás</div>
                <div class="button">Next</div>
                
              </div>
            </form>
          </div>
      
          <div class="modal-body modal-body-step-3">
            <div class="title">Paso 3</div>
                <div class="description">¡Termina de crear tu cuenta!</div>
                <form>
                    <i class="fa-solid fa-user"></i>
                    <input type="text" id="EMAIL" placeholder="Email" />
                    <input type="text" id="PASSWORD" placeholder="Contraseña" />
                  <div class="text-center">
                    <div class="text-center">
                      <div class="back-button">Volver Atrás</div>
                      <input class="boton" type="button" value="Terminar" onclick="BotonGuardar()" />
                      </div>
                    </form>
                  </div>
                </form>


<script type:"text-javascript">

$('.button').click(function() {
  var $btn = $(this),
      $step = $btn.parents('.modal-body'),
      stepIndex = $step.index(),
      $pag = $('.modal-header span').eq(stepIndex);

  if (stepIndex === 0 || stepIndex === 1) {
    step1($step, $pag);
  } else {
    step3($step, $pag);
  }
});
function step1($step, $pag) {
  console.log('step1');
  // animate the step out
  $step.addClass('animate-out');

  // animate the step in
  setTimeout(function() {
    $step.removeClass('animate-out is-showing')
         .next().addClass('animate-in');
    $pag.removeClass('is-active')
        .next().addClass('is-active');
  }, 600);

  // after the animation, adjust the classes
  setTimeout(function() {
    $step.next().removeClass('animate-in')
         .addClass('is-showing');

  }, 1200);

  // Show the back button after moving to the next step
  $('.back-button').css('display', 'inline-block');
}
$('.back-button').click(function() {
  // Find the current step
  const $currentStep = $(this).closest('.modal-body');

  // Find the previous step
  const $prevStep = $currentStep.prev();

  // Animate the current step out
  $currentStep.addClass('animate-out');

  // Animate the previous step in
  setTimeout(function() {
    $currentStep.removeClass('animate-out is-showing');
    $prevStep.addClass('animate-in');
  }, 600);

  // After the animation, adjust the classes
  setTimeout(function() {
    $prevStep.removeClass('animate-in').addClass('is-showing');
  }, 1200);

  // Hide the back button if we're at the first step
  if ($prevStep.hasClass('modal-body-step-1')) {
    $('.back-button').hide();
  }
});
function step3($step, $pag) {
  console.log('3');

  // animate the step out
  $step.parents('.modal-wrap').addClass('animate-up');

  setTimeout(function() {
    $('.rerun-button').css('display', 'inline-block');
  }, 300);
}

$('.rerun-button').click(function() {
  $('.modal-wrap').removeClass('animate-up')
                  .find('.modal-body')
                  .first().addClass('is-showing')
                  .siblings().removeClass('is-showing');

  $('.modal-header span').first().addClass('is-active')
                          .siblings().removeClass('is-active');
  $(this).hide();
});
let imagenbase64 = "";
    $("#FOTO").change(function() {
        readURL(this);
    });
    function readURL(input){
        if (input.files && input.files[0]){
            let reader = new FileReader();

            reader.onload = function(e){
                imagenbase64=e.target.result;
            }
            reader.readAsDataURL(input.files[0]);

        }
    }

function BotonGuardar() { //funcion del boton de guardar, sube los datos a la tabla
let P_instanciada = new personaP(0,
document.getElementById("NOMBRE").value,
document.getElementById("APELLIDO").value,
document.getElementById("EMAIL").value,
document.getElementById("GENERO").value,
document.getElementById("FECHAN").value,
document.getElementById("TIPOUSUARIO").value,
document.getElementById("PASSWORD").value,
imagenbase64
);

console.log(P_instanciada);


    P_instanciada.Guardar().then(function(response) {
        console.log("Success!", response);

swal({
                      icon: 'success',
                      text: 'Se ha registrado correctamente el usurio. ¡Vuelve al login!'
                    });
document.getElementById('cuaerpodelatabladeoperaciones').innerHTML = '';
for(let elemento in response)
{
document.getElementById('cuaerpodelatabladeoperaciones').innerHTML +=
'<tr><td>' + response[elemento].NOMBRE + '</td>' +
'<td>' + response[elemento].APELLIDO + '</td>' +
'<td>' + response[elemento].EMAIL + '</td>' +
'<td>' + response[elemento].TIPOUSUARIO + '</td>' +
'<td>' + response[elemento].PASSWORD + ' </td>' +
'<td> <img src="' + response[elemento].FOTO + '" class="img1" /></td>' +
'<td><input type="button" value="ELIMINAR" onclick="eliminarenbd(\''+response[elemento]._id+'\')" /></td>'
+'</tr>';
}
}, function(error){
console.error("Failed", error);
alert("Error " + error);
});}

function eliminarenbd(iddelaoperacion) //funcion del boton de eliminar
{P_instanciada._id = iddelaoperacion;
P_instanciada.Eliminar().then(function(response)
{
alert('Dato eliminado');
document.getElementById('cuaerpodelatabladeoperaciones').innerHTML = '';
for(let elemento in response)
{
document.getElementById('cuaerpodelatabladeoperaciones').innerHTML +=
'<tr><td>' + response[elemento].NOMBRE + '</td>' +
'<td>' + response[elemento].APELLIDO + '</td>' +
'<td>' + response[elemento].EMAIL + '</td>' +
'<td>' + response[elemento].TIPOUSUARIO + '</td>' +
'<td>' + response[elemento].PASSWORD + ' </td>' +
'<td> <img src="' + response[elemento].FOTO + '" class="img1" /></td>' +
'<td><input type="button" value="ELIMINAR" onclick="eliminarenbd(\''+response[elemento]._id+'\')" /></td>'
+'</tr>';
}
},
function(err)
{
alert(err);
});}
function cargarTabla() { //se llama a la funcion que carga la tabla
  P_instanciada.Listar().then(function(response) {
    for (let elemento in response) {
      document.getElementById('cuaerpodelatabladeoperaciones').innerHTML +=
      '<tr><td>' + response[elemento].NOMBRE + '</td>' +
    '<td>' + response[elemento].APELLIDO + '</td>' +
    '<td>' + response[elemento].EMAIL + '</td>' +
    '<td>' + response[elemento].TIPOUSUARIO + '</td>' +
    '<td>' + response[elemento].PASSWORD + '</td>' +
    '<td> <img src="' + response[elemento].FOTO + '" class="img1"" /></td>' +
    '<td><input type="button" value="ELIMINAR" onclick="eliminarenbd(\''+response[elemento]._id+'\')" /></td>'
+'</tr>';
    }
  }, function(error) {
    console.error("Failed", error);
    alert("Error " + error);
  });
}


</script>
</body>
</html>
    </body>
